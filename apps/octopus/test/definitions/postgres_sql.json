{
  "name": "postgres_sql",
  "execution": {
    "type": "postgrex",
    "start": {
      "args": {
        "connection": {
          "host": "localhost",
          "port": "5432",
          "username": "postgres",
          "password": "postgres",
          "database":"octopus_test"
        },
        "process_name": "my_postgrex_client"
      }
    }
  },
  "interface": {
    "type": "sql",
    "create_users_table": {
      "call": {
        "process_name": "my_postgrex_client",
        "query": "CREATE TABLE users (\n id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,\n name varchar(40) NOT NULL,\n age INTEGER NOT NULL);"
      },
      "input": {
        "args": {}
      },
      "output": "map"
    },
    "drop_users_table": {
      "call": {
        "process_name": "my_postgrex_client",
        "query": "DROP TABLE users;"
      },
      "input": {
        "args": {}
      },
      "output": "map"
    },
    "insert_user": {
      "call": {
        "process_name": "my_postgrex_client",
        "query": "INSERT INTO users (name, age) VALUES ($1, $2);"
      },
      "input": {
        "args": {
          "name": null,
          "age": null
        },
        "transform": {
          "eval": true,
          "template": "[\"<%= args[\"name\"] %>\", <%= args[\"age\"] %>]"
        }
      },
      "output": "map"
    },
    "list_users": {
      "call": {
        "process_name": "my_postgrex_client",
        "query": "SELECT * FROM users;"
      },
      "input": {
        "args": {}
      },
      "output": "map"
    },
    "get_user_by_name": {
      "call": {
        "process_name": "my_postgrex_client",
        "query": "SELECT * FROM users WHERE name = $1;"
      },
      "input": {
        "args": {
          "name": null
        },
        "transform": {
          "eval": true,
          "template": "[\"<%= args[\"name\"] %>\"]"
        }
      },
      "output": "map"
    }
  }
}
